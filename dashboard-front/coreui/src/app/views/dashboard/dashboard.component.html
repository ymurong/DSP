<div *ngIf = "dataLoaded | async">
  <div class="alert alert-warning" style="text-align: center;" role="alert" *ngIf="over3percent">
    <strong>With this configuration, CHARGEBACK RATE exceed 3%. Lower the decision boundary.</strong>
  </div>
  <app-widgets-dropdown [originalMetrics]="original_metrics_widget" [currentMetrics]="current_metrics_widget"></app-widgets-dropdown>
  <c-row>
    <c-col xs>
      <c-card class="mb-4">
        <c-card-header>
          <b>Fraud Classifier </b>
          <span cTooltip="Change the decision boundary to see how the different metrics that depict the historical transactions would react">
            <svg class="text-info" cIcon name="cilInfo"></svg>
          </span>
        </c-card-header>
        <c-card-body>
          <label cLabel for="sensitivity">Decision Boundary - <strong>{{current_threshold}}</strong></label>
          <input [(ngModel)]="current_threshold" id="slider" (change)="updateMetrics()"
                cFormControl
                id=""
                max="1"
                min="0"
                step="0.01"
                type="range" />
        </c-card-body>
        <c-card-footer>
          <c-row class="text-center" [md]="4" [xs]="2">
            <c-col class="mb-sm-2 mb-0">
              <div class="text-medium-emphasis">F1 Score
                <span cTooltip="F1 score measures a model's overall accuracy">
                  <svg class="text-info" cIcon name="cilInfo"></svg>
                </span>
              </div>
              <strong>{{ model_rates.f1 * 100 | number:'2.2-2' }}%</strong>
            </c-col>
            <c-col class="mb-sm-2 mb-0">
              <div class="text-medium-emphasis">Precision 
                <span cTooltip="Precision measures the percentage of transactions predicted as fraud that were correctly classified">
                  <svg class="text-info" cIcon name="cilInfo"></svg>
                </span>
              </div>
              <strong>{{ model_rates.precision * 100 | number:'2.2-2' }}%</strong>
            </c-col>
            <c-col class="mb-sm-2 mb-0">
              <div class="text-medium-emphasis">Recall 
                <span cTooltip="Recall measures the percentage of real fraud transactions that were correctly identified">
                  <svg class="text-info" cIcon name="cilInfo"></svg>
                </span>
              </div>
              <strong>{{ model_rates.recall * 100 | number:'2.2-2' }}%</strong>
            </c-col>
            <c-col class="mb-sm-2 mb-0">
              <div style="display: flex; align-items: center; margin-top: 7px;">
                <a *ngIf="!over3percent" role="button" class="btn btn-success">Change Boundary</a>
                <a *ngIf="over3percent" role="button" class="btn btn-success disabled" aria-disabled="true">Change Boundary</a>
              </div>
            </c-col>
          </c-row>
        </c-card-footer>
      </c-card>
    </c-col>
  </c-row>
  <c-card>
    <c-card-header>
      <strong>Fairness Metrics </strong>
      <span cTooltip="Change the decision boundary to see how the different metrics that depict the historical transactions would react">
        <svg class="text-info" cIcon name="cilInfo"></svg>
      </span>
    </c-card-header>
    <app-fairness [labels]="data_fn_rate.labels" [data_accuracy]="data_balanced_accuracy.datasets[0].data" [data_fn]="data_fn_rate.datasets[0].data"></app-fairness>
  </c-card>
</div>

<div *ngIf = "loading | async">
  <div class="fade show" style="text-align: center; padding-top: calc(75vh / 2);"> <!--height: 100vh">-->
    <i class="spinner-grow spinner-grow-sm"></i>
    <span class="m-1">Loading...</span>
  </div>
</div>
