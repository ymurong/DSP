import { isObject } from 'lodash-es';
import { LibConfig } from '../config/lib-config';
export function isEmbeddedResource(object) {
    // Embedded resource doesn't have self link in _links object
    return !isPagedResourceCollection(object) && !isResourceCollection(object) && isResourceObject(object) && !('self' in object._links);
}
export function isResource(object) {
    return !isPagedResourceCollection(object) && !isResourceCollection(object) && isResourceObject(object) && ('self' in object._links);
}
export function isResourceCollection(object) {
    const baseCondition = isObject(object) &&
        ('_links' in object) &&
        !('page' in object);
    if (!baseCondition) {
        return false;
    }
    if (LibConfig.getConfig().halFormat.collections.embeddedOptional) {
        return baseCondition && (Object.keys(object).length === 1 ||
            '_embedded' in object && Object.keys(object).length === 2);
    }
    else {
        return baseCondition && '_embedded' in object && Object.keys(object).length === 2;
    }
}
export function isPagedResourceCollection(object) {
    const baseCondition = isObject(object) &&
        ('_links' in object) &&
        ('page' in object);
    if (!baseCondition) {
        return false;
    }
    if (LibConfig.getConfig().halFormat.collections.embeddedOptional) {
        return baseCondition && (Object.keys(object).length === 2 ||
            '_embedded' in object && Object.keys(object).length === 3);
    }
    else {
        return baseCondition && '_embedded' in object && Object.keys(object).length === 3;
    }
}
/**
 * Check that passed object has links property.
 *
 * @param object which need to check links property
 */
export function isResourceObject(object) {
    return isObject(object) && ('_links' in object);
}
/**
 * Defining resource type bypassed object.
 *
 * @param object that presumably is one of resource type
 */
export function getResourceType(object) {
    if (isEmbeddedResource(object)) {
        return 'EmbeddedResource';
    }
    else if (isResource(object)) {
        return 'Resource';
    }
    else if (isResourceCollection(object)) {
        return 'ResourceCollection';
    }
    else if (isPagedResourceCollection(object)) {
        return 'PagedResourceCollection';
    }
    else {
        return 'Unknown';
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVzb3VyY2UtdHlwZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL25neC1oYXRlb2FzLWNsaWVudC9zcmMvbGliL21vZGVsL3Jlc291cmNlLXR5cGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLFdBQVcsQ0FBQztBQUNyQyxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFFakQsTUFBTSxVQUFVLGtCQUFrQixDQUFDLE1BQVc7SUFDNUMsNERBQTREO0lBQzVELE9BQU8sQ0FBQyx5QkFBeUIsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLG9CQUFvQixDQUFDLE1BQU0sQ0FBQyxJQUFJLGdCQUFnQixDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQ3ZJLENBQUM7QUFFRCxNQUFNLFVBQVUsVUFBVSxDQUFDLE1BQVc7SUFDcEMsT0FBTyxDQUFDLHlCQUF5QixDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsTUFBTSxDQUFDLElBQUksZ0JBQWdCLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQ3RJLENBQUM7QUFFRCxNQUFNLFVBQVUsb0JBQW9CLENBQUMsTUFBVztJQUM5QyxNQUFNLGFBQWEsR0FBRyxRQUFRLENBQUMsTUFBTSxDQUFDO1FBQ3BDLENBQUMsUUFBUSxJQUFJLE1BQU0sQ0FBQztRQUNwQixDQUFDLENBQUMsTUFBTSxJQUFJLE1BQU0sQ0FBQyxDQUFDO0lBQ3RCLElBQUksQ0FBQyxhQUFhLEVBQUU7UUFDbEIsT0FBTyxLQUFLLENBQUM7S0FDZDtJQUVELElBQUksU0FBUyxDQUFDLFNBQVMsRUFBRSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsZ0JBQWdCLEVBQUU7UUFDaEUsT0FBTyxhQUFhLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sS0FBSyxDQUFDO1lBQ3ZELFdBQVcsSUFBSSxNQUFNLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxNQUFNLEtBQUssQ0FBQyxDQUFDLENBQUM7S0FDOUQ7U0FBTTtRQUNMLE9BQU8sYUFBYSxJQUFJLFdBQVcsSUFBSSxNQUFNLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxNQUFNLEtBQUssQ0FBQyxDQUFDO0tBQ25GO0FBQ0gsQ0FBQztBQUVELE1BQU0sVUFBVSx5QkFBeUIsQ0FBQyxNQUFXO0lBQ25ELE1BQU0sYUFBYSxHQUFHLFFBQVEsQ0FBQyxNQUFNLENBQUM7UUFDcEMsQ0FBQyxRQUFRLElBQUksTUFBTSxDQUFDO1FBQ3BCLENBQUMsTUFBTSxJQUFJLE1BQU0sQ0FBQyxDQUFDO0lBQ3JCLElBQUksQ0FBQyxhQUFhLEVBQUU7UUFDbEIsT0FBTyxLQUFLLENBQUM7S0FDZDtJQUVELElBQUksU0FBUyxDQUFDLFNBQVMsRUFBRSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsZ0JBQWdCLEVBQUU7UUFDaEUsT0FBTyxhQUFhLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sS0FBSyxDQUFDO1lBQ3ZELFdBQVcsSUFBSSxNQUFNLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxNQUFNLEtBQUssQ0FBQyxDQUFDLENBQUM7S0FDOUQ7U0FBTTtRQUNMLE9BQU8sYUFBYSxJQUFJLFdBQVcsSUFBSSxNQUFNLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxNQUFNLEtBQUssQ0FBQyxDQUFDO0tBQ25GO0FBQ0gsQ0FBQztBQUVEOzs7O0dBSUc7QUFDSCxNQUFNLFVBQVUsZ0JBQWdCLENBQUMsTUFBVztJQUMxQyxPQUFPLFFBQVEsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFFBQVEsSUFBSSxNQUFNLENBQUMsQ0FBQztBQUNsRCxDQUFDO0FBRUQ7Ozs7R0FJRztBQUNILE1BQU0sVUFBVSxlQUFlLENBQUMsTUFBVztJQUN6QyxJQUFJLGtCQUFrQixDQUFDLE1BQU0sQ0FBQyxFQUFFO1FBQzlCLE9BQU8sa0JBQWtCLENBQUM7S0FDM0I7U0FBTSxJQUFJLFVBQVUsQ0FBQyxNQUFNLENBQUMsRUFBRTtRQUM3QixPQUFPLFVBQVUsQ0FBQztLQUNuQjtTQUFNLElBQUksb0JBQW9CLENBQUMsTUFBTSxDQUFDLEVBQUU7UUFDdkMsT0FBTyxvQkFBb0IsQ0FBQztLQUM3QjtTQUFNLElBQUkseUJBQXlCLENBQUMsTUFBTSxDQUFDLEVBQUU7UUFDNUMsT0FBTyx5QkFBeUIsQ0FBQztLQUNsQztTQUFNO1FBQ0wsT0FBTyxTQUFTLENBQUM7S0FDbEI7QUFDSCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNPYmplY3QgfSBmcm9tICdsb2Rhc2gtZXMnO1xuaW1wb3J0IHsgTGliQ29uZmlnIH0gZnJvbSAnLi4vY29uZmlnL2xpYi1jb25maWcnO1xuXG5leHBvcnQgZnVuY3Rpb24gaXNFbWJlZGRlZFJlc291cmNlKG9iamVjdDogYW55KSB7XG4gIC8vIEVtYmVkZGVkIHJlc291cmNlIGRvZXNuJ3QgaGF2ZSBzZWxmIGxpbmsgaW4gX2xpbmtzIG9iamVjdFxuICByZXR1cm4gIWlzUGFnZWRSZXNvdXJjZUNvbGxlY3Rpb24ob2JqZWN0KSAmJiAhaXNSZXNvdXJjZUNvbGxlY3Rpb24ob2JqZWN0KSAmJiBpc1Jlc291cmNlT2JqZWN0KG9iamVjdCkgJiYgISgnc2VsZicgaW4gb2JqZWN0Ll9saW5rcyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1Jlc291cmNlKG9iamVjdDogYW55KTogYm9vbGVhbiB7XG4gIHJldHVybiAhaXNQYWdlZFJlc291cmNlQ29sbGVjdGlvbihvYmplY3QpICYmICFpc1Jlc291cmNlQ29sbGVjdGlvbihvYmplY3QpICYmIGlzUmVzb3VyY2VPYmplY3Qob2JqZWN0KSAmJiAoJ3NlbGYnIGluIG9iamVjdC5fbGlua3MpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNSZXNvdXJjZUNvbGxlY3Rpb24ob2JqZWN0OiBhbnkpOiBib29sZWFuIHtcbiAgY29uc3QgYmFzZUNvbmRpdGlvbiA9IGlzT2JqZWN0KG9iamVjdCkgJiZcbiAgICAoJ19saW5rcycgaW4gb2JqZWN0KSAmJlxuICAgICEoJ3BhZ2UnIGluIG9iamVjdCk7XG4gIGlmICghYmFzZUNvbmRpdGlvbikge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGlmIChMaWJDb25maWcuZ2V0Q29uZmlnKCkuaGFsRm9ybWF0LmNvbGxlY3Rpb25zLmVtYmVkZGVkT3B0aW9uYWwpIHtcbiAgICByZXR1cm4gYmFzZUNvbmRpdGlvbiAmJiAoT2JqZWN0LmtleXMob2JqZWN0KS5sZW5ndGggPT09IDEgfHxcbiAgICAgICdfZW1iZWRkZWQnIGluIG9iamVjdCAmJiBPYmplY3Qua2V5cyhvYmplY3QpLmxlbmd0aCA9PT0gMik7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGJhc2VDb25kaXRpb24gJiYgJ19lbWJlZGRlZCcgaW4gb2JqZWN0ICYmIE9iamVjdC5rZXlzKG9iamVjdCkubGVuZ3RoID09PSAyO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1BhZ2VkUmVzb3VyY2VDb2xsZWN0aW9uKG9iamVjdDogYW55KTogYm9vbGVhbiB7XG4gIGNvbnN0IGJhc2VDb25kaXRpb24gPSBpc09iamVjdChvYmplY3QpICYmXG4gICAgKCdfbGlua3MnIGluIG9iamVjdCkgJiZcbiAgICAoJ3BhZ2UnIGluIG9iamVjdCk7XG4gIGlmICghYmFzZUNvbmRpdGlvbikge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGlmIChMaWJDb25maWcuZ2V0Q29uZmlnKCkuaGFsRm9ybWF0LmNvbGxlY3Rpb25zLmVtYmVkZGVkT3B0aW9uYWwpIHtcbiAgICByZXR1cm4gYmFzZUNvbmRpdGlvbiAmJiAoT2JqZWN0LmtleXMob2JqZWN0KS5sZW5ndGggPT09IDIgfHxcbiAgICAgICdfZW1iZWRkZWQnIGluIG9iamVjdCAmJiBPYmplY3Qua2V5cyhvYmplY3QpLmxlbmd0aCA9PT0gMyk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGJhc2VDb25kaXRpb24gJiYgJ19lbWJlZGRlZCcgaW4gb2JqZWN0ICYmIE9iamVjdC5rZXlzKG9iamVjdCkubGVuZ3RoID09PSAzO1xuICB9XG59XG5cbi8qKlxuICogQ2hlY2sgdGhhdCBwYXNzZWQgb2JqZWN0IGhhcyBsaW5rcyBwcm9wZXJ0eS5cbiAqXG4gKiBAcGFyYW0gb2JqZWN0IHdoaWNoIG5lZWQgdG8gY2hlY2sgbGlua3MgcHJvcGVydHlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzUmVzb3VyY2VPYmplY3Qob2JqZWN0OiBhbnkpIHtcbiAgcmV0dXJuIGlzT2JqZWN0KG9iamVjdCkgJiYgKCdfbGlua3MnIGluIG9iamVjdCk7XG59XG5cbi8qKlxuICogRGVmaW5pbmcgcmVzb3VyY2UgdHlwZSBieXBhc3NlZCBvYmplY3QuXG4gKlxuICogQHBhcmFtIG9iamVjdCB0aGF0IHByZXN1bWFibHkgaXMgb25lIG9mIHJlc291cmNlIHR5cGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFJlc291cmNlVHlwZShvYmplY3Q6IGFueSk6IHN0cmluZyB7XG4gIGlmIChpc0VtYmVkZGVkUmVzb3VyY2Uob2JqZWN0KSkge1xuICAgIHJldHVybiAnRW1iZWRkZWRSZXNvdXJjZSc7XG4gIH0gZWxzZSBpZiAoaXNSZXNvdXJjZShvYmplY3QpKSB7XG4gICAgcmV0dXJuICdSZXNvdXJjZSc7XG4gIH0gZWxzZSBpZiAoaXNSZXNvdXJjZUNvbGxlY3Rpb24ob2JqZWN0KSkge1xuICAgIHJldHVybiAnUmVzb3VyY2VDb2xsZWN0aW9uJztcbiAgfSBlbHNlIGlmIChpc1BhZ2VkUmVzb3VyY2VDb2xsZWN0aW9uKG9iamVjdCkpIHtcbiAgICByZXR1cm4gJ1BhZ2VkUmVzb3VyY2VDb2xsZWN0aW9uJztcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gJ1Vua25vd24nO1xuICB9XG59XG4iXX0=